<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket de Venta</title>
    <style>
        /* Tus estilos aquí */
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="ticket" id="ticket">
        <h2>Nombre de la Empresa</h2>
        <!-- Contenido del ticket -->
    </div>

    <div class="share-icon">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/2048px-WhatsApp.svg.png" alt="Compartir en WhatsApp" onclick="shareTicket()" />
    </div>

    <script>
        function shareTicket() {
            html2canvas(document.getElementById('ticket')).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const blob = dataURItoBlob(imgData);

                const formData = new FormData();
                formData.append('file', blob, 'ticket.png');

                // Reemplaza esto con tu URL real
                fetch('URL_DE_TU_SERVIDOR/api/upload', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    const whatsappUrl = `https://api.whatsapp.com/send?text=Aquí tienes el ticket: ${data.link}`;
                    window.open(whatsappUrl, '_blank');
                })
                .catch(err => console.error('Error al subir la imagen:', err));
            });
        }

        function dataURItoBlob(dataURI) {
            const byteString = atob(dataURI.split(',')[1]);
            const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
            const ab = new ArrayBuffer(byteString.length);
            const ia = new Uint8Array(ab);
            for (let i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            return new Blob([ab], { type: mimeString });
        }
    </script>
</body>
</html>
